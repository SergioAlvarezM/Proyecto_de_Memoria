@startuml

' Variable definition
!$file = "(F,#ff75ff) File"

' Configuration definition
title Class Diagram For Reliefe Creator
set namespaceSeparator .

' Package hierarchy
package src {
    package engine {
        package model {
            package transformations {}
        }
        package render {}
        package data {}
        package controller {}
        package GUI {
            package frames {}
        }
        package scene {}
    }
    package input {}
    package program {}
}


' Classes definition
class src.engine.GUI.GUIManager{
    - __implementation: GlfwRenderer
    - __glfw_window: GLFWWindow
    - __component_list: list
    - __io: IMGUI.io
    - __font: IMGUI.font
    - __scene: Scene
    - __engine: Engine

    {static} + get_frames(gui_manager) : list
    + change_color_file(path_color_file)
    + are_frame_fixed()
    + initialize(window, mode)
    + add_frames(component_list)
    + add_zoom()
    + less_zoom()
    + fix_frames_position(value)
    + process_input()
    + draw_frames()
    + reload_models()
    + refresh_scene_with_model_2d(path_color_file, path_model, model_id)
    + render()
    + set_polygon_mode(polygon_mode)
    + get_main_menu_bar_height(): int
    + get_cpt_file(): str
    + get_left_frame_width(): int
    + get_window_height(): int
    + get_window_width(): int
    + get_active_tool(): str
    + get_zoom_level(): float
    + get_map_position(): list
    + get_view_mode(): str
}

class src.engine.settings  {
    {static} + CLEAR_COLOR : list
    {static} + fix_frames(fix_frames): boolean
    {static} + FIXEX_FRAMES : boolean
    {static} + FLOAT_BYTES : int
    {static} + FONT_SIZE : int
    {static} + HEIGHT : int
    {static} + LEFT_FRAME_WIDTH : int
    {static} + MAIN_MENU_BAR_HEIGHT : int
    {static} + SCENE_BEGIN_X : int
    {static} + SCENE_BEGIN_Y : int
    {static} + SCENE_WIDTH_X : int
    {static} + SCENE_HEIGHT_Y : int
    {static} + VIEW_MODE : str
    {static} + TOP_FRAME_HEIGHT : int
    {static} + WIDTH : int
    {static} + update_scene_values()
}

class src.engine.model.transformations.transformations <<$file>> {
    + identity() : array
    + uniformScale(s) : array
    + scale(sx,sy,sz) : array
    + rotationX(theta) : array
    + rotationY(theta) : array
    + rotationZ(theta) : array
    + rotationA(theta, axis) : array
    + translate(tx, ty, tz) : array
    + shearing(xy, yx, xz, zx, yz, zy) : array
    + matmul(mats) : array
    + frustum(left, right, bottom, top, near, far) : array
    + perspective(fovy, aspect, near, far) : array
    + ortho(left, right, bottom, top, near, far) : array
    + lookAt(eye, at, up) : array
}


class src.engine.model.Model {

    + vao : int
    + vbo : int
    + cbo : int
    + ebo : int
    + shader_program : compiled_shader
    + position : numpy.array[3]
    + rotation : numpy.array[3]
    + indices_size: int
    + draw_mode : GL_DRAW_MODE
    + polygon_mode : GL_POLYGON_MODE
    + update_uniform_values : boolean
    + id : str

    ~ _update_uniforms()
    + set_color_file(color_file)
    + set_shaders(vertex_shader, fragment_shader)
    + set_vertices(vertex)
    + set_indices(indices)
    + draw()
}

class src.engine.render.Render {
    + __window : GLFWWindow
    + __gui : GUIManager
    + init(window_name)
    + on_loop(on_frame_task)
}

class src.input.NetCDF <<$file>> {
    + read_info(filename) -> array, array, array
}

class src.engine.data.decimation <<$file>>{
    + simple_decimation(x, y, z, n_rows, n_cols): array, array, array
}

class src.utils <<$file>>{
    + LOG_LEVEL : int
    + LOG_FILE_LEVEL : int
    + interpolate(value, value_min, value_max, target_min,target_max) : float
    + get_logger(log_level, log_file_level, module, directory) : logger
}

class src.engine.model.Map2DModel{
    - __x : array
    - __y : array
    - __z : array
    - __color_file : str
    - __colors : array
    - __height_limit : array
    - __vertices : list
    - __indices : list
    - __height : list
    - __max_height : float
    - __min_height : float
    - __projection : list
    - __left_coordinate : int
    - __right_coordinate : int
    - __top_coordinate : int
    - __bottom_coordinate : int
    + hbo : int

    - __print_vertices()
    - __print_indices()
    - __set_height_buffer()
    - __generate_vertices_list(x, y, z, z_value): list
    - __get_vertex_index(x_pos, y_pos): int
    - __get_index_closest_value(list_to_evaluate, value): int
    - __generate_index_list(step_x, step_y, left_coordinate, right_coordinate, top_coordinate, bottom_coordinate): list
    - __is_triangle_inside_zone(index_triangle, left_coordinate, right_coordinate, top_coordinate, bottom_coordinate): bool:
    - __delete_triangles_inside_zone(left_coordinate, right_coordinate, top_coordinate, bottom_coordinate)
    - recalculate_vertices_from_grid(quality)
    ~ _update_uniforms()
    + calculate_projection_matrix(scene_data, zoom_level)
    + set_color_file(filename)
    + set_vertices_from_grid(x,y,z,quality)

}

class src.input.CTP <<$file>> {
    + read_file(filename: str) : dict
}

class src.engine.model.Map3DModel{

}

'class src.main <<$file>> {
'
'}

class src.engine.GUI.frames.Frame {
    ~ _position: list
    ~ _GUI_manager: GUIManager

    + change_position(new_position)
    + get_position(): list
    + render()
}

class src.engine.GUI.frames.MainMenuBar {
    + render()
}

class src.engine.GUI.frames.Tools {
    - double_button_margin_width: int
    - button_margin_width: int
    + render()
}

class src.engine.GUI.frames.Debug {
    - __height: int
    + render()
}

class src.engine.GUI.frames.TestWindow {
    + render()
}

class src.engine.controller.Controller {
    - __render : Render
    - __scene : Scene
    - __engine : Engine
    + init(render)
    + get_on_key_callback()
    + get_resize_callback()
}

class src.engine.scene.Scene {
    - __model_list : list
    - __engine : Engine
    - __width_viewport: int
    - __height_viewport: int
    + add_model(model)
    + draw()
    + update_viewport_variables()
    + update_models_projection_matrix()
    + initialize(engine)
    + refresh_with_model_2d(path_color_file, path_model, model_id)
    + remove_all_models()
    + reload_models()
    + remove_model(id_model)
    + update_models_colors()
    + set_polygon_mode(polygon_mode)
    + update_viewport()
}

class src.engine.Engine {
    + controller
    + get_cpt_file(): str
    + gui_manager
    + render
    + scene
    + window
    + initialize(engine)
    + reload_models()
    + change_color_file(path_color_file)
    + get_CPT_file()
    + get_zoom_level(): float
    + refresh_with_model_2d(path_color_file, path_model, model_id)
    + run()
    + reset_zoom_level()
    + add_zoom()
    + less_zoom()
    + get_map_position(): list
    + get_active_tool(): str
    {static} + get_view_mode(): str
    {static} + change_height_window(height)
    {static} + change_width_window(width)
    {static} + get_gui_setting_data(): dict
    {static} + get_font_size(): int
    {static} + fix_frames()
    {static} + are_frames_fixed(): boolean
    {static} + get_window_setting_data(): dict
    {static} + update_scene_values()
    {static} + get_clear_color(): list
    {static} + get_scene_setting_data(): dict

}

class src.program.Program {

    - __engine: Engine
    - __CPT_file: str
    - __model_id: str
    - __zoom_level: float
    - __map_position: list
    - __active_tool: str

    + run()
    + initialize(program)
    + reset_zoom_level()
    + add_zoom()
    + less_zoom()
    + set_cpt_file(new_file)
    + set_model_id(new_model_id)
    + set_active_tool(new_tool)
    + get_cpt_file(): str
    + get_active_tool(): str
    + get_map_position(): list
}

' herency
src.engine.model.Map2DModel -u-|> src.engine.model.Model
src.engine.model.Map3DModel -u-|> src.engine.model.Model

src.engine.GUI.frames.MainMenuBar -u-|> src.engine.GUI.frames.Frame
src.engine.GUI.frames.Tools -u-|> src.engine.GUI.frames.Frame
src.engine.GUI.frames.TestWindow -u-|> src.engine.GUI.frames.Frame
src.engine.GUI.frames.Debug -u-|> src.engine.GUI.frames.Frame

' uses
src.engine.model.Map2DModel -u.> src.engine.data.decimation
src.engine.model.Map2DModel -u.> src.engine.model.transformations.transformations
src.engine.model.Map2DModel -u.> src.input.CTP

src.engine.model.Model -u.> src.engine.settings

src.engine.Engine <-d.> src.engine.render.Render
src.engine.Engine <-d.> src.engine.GUI.GUIManager
src.engine.Engine <-d.> src.engine.controller.Controller
src.engine.Engine <-d.> src.engine.scene.Scene
src.engine.Engine -u.> src.engine.settings
src.engine.Engine <-l.> src.program.Program

src.engine.GUI.frames.Frame <-u.> src.engine.GUI.GUIManager

src.engine.scene.Scene -u.> src.engine.model.Map2DModel
src.engine.scene.Scene -u.> src.engine.model.Model
src.engine.scene.Scene -u.> src.input.NetCDF
@enduml